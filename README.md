# crawling
selenium library를 사용해서 crawling을 진행하고 있습니다.

### 2021.06.30.
AWS 서버에서 실행해본 결과 윈도우 환경과는 다르게 네트워크에 다양한 원인들로 인해 속도 저하가 발생하게 되는데
이러한 이유로 tiem sleep이나 wait로 페이지가 로드 되는 것을 기다리는 것이 무의미해졌습니다.

time delay를 사용하지 않고 crawling하는 방법을 고안 중입니다. (+일단은 서버에서도 돌아가도록 수정)

### 2021.07.01.
속도 저하와 네트워크 문제로 time sleep으로 loading delay를 해결하려고 했던 부분들에서 모두 오류가 발생하였습니다.
그래서 이를 해결하기 위해서 새로운 방법을 사용했는데 무한 루프를 사용해서 조건이 충족되는 것을 기다리는 것입니다.

사실 맨 처음에 생각한 방법이긴 했으나 time delay를 주는 것보다 속도도 느리고 오버헤드도 클 것으로 생각했으나 (웹에 대한 잘못된 지식으로)
생각보다 loading 속도는 매우 느렸고 아이템들의 loading 속도도 천차만별인 문제가 있었습니다.

당연히 하나가 로드되면 나머지도 사용할 수 있을 것이라는 잘못된 전제로 인해 코드를 많이 수정했습니다.

웹에서 당연한 이야기들을 모르고 시작해서 오류를 분석하면서 이러한 특징이 있다는 것을 찾는데 너무 오랜 시간을 썼고
결국에는 while로 대기를 하도록 진행했습니다.

(+) 현재 개발 중인 코드는 확장성 문제와 위와 같이 잘못된 시작으로 인해 많은 문제가 있어서 새로운 알고리즘을 사용해서 크롤링을 더 빠르고 오류 없이 할 수 있도록
    할 계획입니다. test.py는 오늘 시작한 새로운 크롤링 코드

### 2021.07.02.
![image](https://user-images.githubusercontent.com/72551588/124287875-7da78600-db8b-11eb-990d-1d55178ff54a.png)
- 사이트에서 product url 다운 받는 코드를 수정했습니다. 수정 후에는 전체 상품을 받아올 수 있게 되어서 더 많은 데이터로 테스트를 진행했습니다.
- 서버에서 드디어 리뷰 크롤링에 성공했습니다. 강제로 time delay를 주게 되었을 때 한계점들과 안정성 측면에서 문제가 발생했는데 이러한 문제들을 해결하기 위해 지속적으로 sleep이나 time wait 함수를 사용하지 않고 대기할 수 있도록 while문으로 변경했습니다. 덕분에 오류가 발생하지 않고 모든 데이터를 크롤링할 수 있었습니다.
- 윈도우 환경에서 새로 개발 중인 코드를 기능 부분을 완성했습니다. 가장 큰 문제 중 하나였던 확장성 문제 해결을 위해 class가 아니라 link text나 id를 사용하였습니다.
- class를 사용하지 못해서 각각의 리뷰로 데이터를 가져올 수 없었는데 모든 데이터를 크롤링할 수 있도록 환경을 만들고 가져온 후 각각의 리뷰로 분리를 하는 방법으로 구성했습니다.
- 이미지의 경우에 각각의 리뷰에 매핑이 필요했는데 현재는 각 리뷰별로 고유한 데이터인 사용자의 아이디를 이용하여 매핑을 진행했습니다. 하지만 같은 사용자가 리뷰를 연속으로 올리는 경우도 있기 때문에 아이디와 같은 고유 데이터를 통해 데이터를 분리하면서 동시에 예외 케이스에 대한 부분도 수정이 필요합니다.
- 이외에도 리뷰 내용 분리를 위해 사용한 알고리즘도 예외 케이스가 여러 존재하기 때문에 확장성을 높이면서 예외 케이스를 줄일 수 있는 방법을 추가적으로 도입할 계획입니다.
- 안정성 테스트를 위해 기존의 완성된 코드는 다른 사이트에서도 원활하게 동작하는지 확인하는 작업을 계속 진행합니다.

### 2021.07.05.
![image](https://user-images.githubusercontent.com/72551588/124457253-8d5ede80-ddc6-11eb-90fc-161563e70c46.png)
- 기존 코드로 새로운 사이트 리뷰를 크롤링했습니다. 이전에 발생했던 문제들이 완전히 해결되었다고 생각합니다. 다른 오류가 생길 수도 있고 다른 사이트에서는 예외 케이스가 있을 수 있기 때문에 지속적으로 테스트 할 계획입니다.
- 새로운 알고리즘 코드를 1차적으로 완성했습니다. 현재 윈도우 환경에서 테스트 중에 있었고 여러 가지 문제가 발생했었습니다.
- 역시나 페이지 변경이 제대로 되었는지 확인할 방법이 필요했는데 완전한 방법으로 구현하지 않아서 문제가 발생했습니다.
- 페이지 변경이 제대로 동작하지 않아서 이후에 있는 코드들에서도 연쇄적으로 문제가 발생했습니다.
- 특히 정렬 버튼 누르는 부분에서 오류가 지속적으로 발생했는데 시간 딜레이에 의한 문제인지 아니면 구조적으로 발생하는 문제인지 확인 중에 있습니다.
- 내일 윈도우 환경에서 오류 없이 동작한다면 서버 환경에서도 동작시켜 볼 계획입니다.
